# AutoExifWatermark ğŸ“·âœ¨

ä¸€ä¸ªæœ¬åœ°éƒ¨ç½²çš„è‡ªåŠ¨åŒ–ç…§ç‰‡æ°´å°å·¥å…·ï¼Œä¸ºæ‚¨çš„æ‘„å½±ä½œå“å¢æ·»ä¸“ä¸šç­¾åã€‚æˆ‘æœ¬äººæ˜¯ç”¨åœ¨nasä¸Šé¢çš„ï¼Œäº¦å¯è¿è¡Œäºä»»ä½•Linuxè®¾å¤‡ï¼Œå¦‚æœç”¨åœ¨Windowsä¸Šè¯·è‡ªè¡Œä¿®æ”¹ã€‚


![](./target/e338596223da2e06c3e3efb486654191.jpg)

ï¼ˆå¯Œå£«logoæœ‰ç‚¹å°ï¼Œå› ä¸ºæˆ‘æœ¬äººæ²¡æœ‰å¯Œå£«è®¾å¤‡ï¼Œå·æ‡’äº†ï¼Œå¯ä»¥è‡ªå·±æ‰¾äº†æ›¿æ¢logoç›¸å†Œé‡Œé¢çš„å›¾ç‰‡ï¼‰

![](./target/IMG_20250330_160732_1.jpeg)

---

### ğŸ“– é¡¹ç›®ç®€ä»‹

AutoExifWatermarkæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€**å¯æœ¬åœ°éƒ¨ç½²çš„Pythonè„šæœ¬**ã€‚å®ƒé€šè¿‡ç›‘æ§æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼Œä¸ºæ–°åŠ å…¥çš„ç…§ç‰‡è‡ªåŠ¨æ·»åŠ ä¸€ä¸ªåŒ…å«EXIFä¿¡æ¯ã€å“ç‰ŒLogoå’Œä¸»è‰²è°ƒè‰²å¡çš„ç²¾ç¾æ°´å°ã€‚

æœ¬é¡¹ç›®çš„å¼€å‘åˆè¡·æ˜¯ä¸ºäº†åœ¨**NASï¼ˆç½‘ç»œé™„åŠ å­˜å‚¨ï¼‰**ä¸Šå®ç°ä¸€ä¸ªå…¨è‡ªåŠ¨ã€æ— äººå€¼å®ˆçš„ç…§ç‰‡å¤„ç†æµç¨‹ï¼Œä½†å…¶è®¾è®¡å…·æœ‰è‰¯å¥½çš„é€šç”¨æ€§ï¼Œå¯ä»¥è½»æ¾åœ°è¿è¡Œåœ¨**ä»»ä½•Linuxç¯å¢ƒ**ä¸­ï¼Œä¾‹å¦‚ï¼š

-   å®¶ç”¨NAS (å¦‚ç¾¤æ™–ã€å¨è”é€šï¼Œæˆ–æ¯”å¦‚æˆ‘æ­£åœ¨ä½¿ç”¨çš„é£ç‰›OS)
-   æ ‘è“æ´¾ (Raspberry Pi)
-   ä¸€å°ä¸“é—¨çš„Linuxå®¶ç”¨æœåŠ¡å™¨
-   æ‚¨çš„ä¸ªäººLinuxå°å¼æœºæˆ–ç¬”è®°æœ¬ç”µè„‘
-   äº‘æœåŠ¡å™¨ (VPS)

### âœ¨ ä¸»è¦ç‰¹æ€§

- **å…¨è‡ªåŠ¨åŒ–è¿è¡Œ**: è®¾ç½®ä¸º `systemd` æœåŠ¡åï¼Œå¯7x24å°æ—¶æ— äººå€¼å®ˆè¿è¡Œï¼ŒçœŸæ­£çš„â€œå³æ”¾å³å¿˜â€(set-it-and-forget-it)ã€‚
- **EXIFä¿¡æ¯é©±åŠ¨**: æ°´å°å†…å®¹è‡ªåŠ¨ä»ç…§ç‰‡çš„EXIFæ•°æ®ä¸­è¯»å–ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥ã€‚
- **ä¸“ä¸šä¸”ç¾è§‚çš„æ’ç‰ˆ**: æ¨¡ä»¿ä¸»æµæ‘„å½±ç¤¾åŒºçš„é£æ ¼ï¼Œæ°´å°å¸ƒå±€ä¼˜é›…ï¼Œä¿¡æ¯æ¸…æ™°ã€‚
- **å“ç‰ŒLogoæ”¯æŒ**: è‡ªåŠ¨è¯†åˆ«ç›¸æœº**å“ç‰Œ**ï¼ˆå¦‚SONY, Canon, FUJIFILMï¼‰ï¼Œå¹¶åŠ è½½å¯¹åº”çš„PNG Logoï¼Œå¦‚æœæ‰¾ä¸åˆ°Logoåˆ™ä¼˜é›…åœ°é™çº§ä¸ºæ˜¾ç¤ºçº¯æ–‡æœ¬ã€‚
- **åŠ¨æ€è‰²å½©åˆ†æ**: åˆ©ç”¨K-Meansèšç±»ç®—æ³•ï¼Œè‡ªåŠ¨æå–ç…§ç‰‡ä¸»è‰²è°ƒï¼Œç”Ÿæˆä¸ç”»é¢é£æ ¼åŒ¹é…çš„è‰²å¡ã€‚
- **è‡ªé€‚åº”åŠ¨æ€ç¼©æ”¾**: æ°´å°çš„æ‰€æœ‰å…ƒç´ ï¼ˆLogoã€å­—ä½“ã€é—´è·ï¼‰ä¼šæ ¹æ®ç…§ç‰‡çš„å®½åº¦è¿›è¡Œç­‰æ¯”ç¼©æ”¾ï¼Œç¡®ä¿åœ¨ä»»ä½•åˆ†è¾¨ç‡çš„å›¾ç‰‡ä¸Šéƒ½ä¿æŒåè°ƒç¾è§‚ã€‚
- **å¥å£®å¯é **: 
    - é‡‡ç”¨**å®šæ—¶è½®è¯¢**æœºåˆ¶ï¼Œå®Œç¾å…¼å®¹å„ç§æ–‡ä»¶ç³»ç»Ÿï¼ˆç‰¹åˆ«æ˜¯ç½‘ç»œæŒ‚è½½çš„å…±äº«æ–‡ä»¶å¤¹ï¼‰ã€‚
    - åŒ…å«äº†ä¸°å¯Œçš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œå¯¹ä¸è§„èŒƒçš„EXIFæ•°æ®ã€æœ‰é—®é¢˜çš„å›¾ç‰‡æ ¼å¼éƒ½èƒ½ç¨³å¥å¤„ç†ã€‚
    - å¤±è´¥çš„æ–‡ä»¶ä¼šè‡ªåŠ¨ç§»å…¥`failed_photos`æ–‡ä»¶å¤¹ï¼Œä¾¿äºæ’æŸ¥ã€‚

### ğŸ”§ å®‰è£…ä¸é…ç½®

#### 1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/gladiouszhang/AutoExifWatermark.git
cd AutoExifWatermark
```

#### 2. å‡†å¤‡ç¯å¢ƒ (åŸºäº Debian/Ubuntu)
```bash
# å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒå·¥å…·
sudo apt update
sudo apt install python3-venv
```

#### 3. åˆ›å»ºå¹¶é…ç½®è™šæ‹Ÿç¯å¢ƒ
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºvenvæ–‡ä»¶å¤¹
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å®‰è£…æ‰€æœ‰Pythonä¾èµ–
pip install --upgrade pip
pip install Pillow numpy scikit-learn
```

#### 4. ä¸ªæ€§åŒ–é…ç½®

1.  **å­—ä½“**: å°†æ‚¨å–œæ¬¢çš„`.ttf`æˆ–`.otf`å­—ä½“æ–‡ä»¶æ”¾å…¥ `fonts/` æ–‡ä»¶å¤¹ã€‚æ¨èä½¿ç”¨æ— è¡¬çº¿ã€å­—é‡ä¸°å¯Œçš„å­—ä½“ã€‚è¯·ç¡®ä¿è„šæœ¬ä¸­çš„`FONT_FILE`å˜é‡æŒ‡å‘æ­£ç¡®çš„æ–‡ä»¶åã€‚
2.  **å“ç‰ŒLogo**: å°†æ‚¨çš„ç›¸æœº**å“ç‰ŒLogo**ï¼ˆå¿…é¡»æ˜¯`.png`æ ¼å¼ï¼Œæ”¯æŒé€æ˜èƒŒæ™¯ï¼‰æ”¾å…¥ `logos/` æ–‡ä»¶å¤¹ã€‚
    - **é‡è¦**: Logoæ–‡ä»¶åéœ€è¦ä¸ç…§ç‰‡EXIFå…ƒæ•°æ®ä¸­çš„`Make`å­—æ®µ**å®Œå…¨ä¸€è‡´**ï¼ˆåŒ…æ‹¬å¤§å°å†™ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœEXIFä¸­çš„å“ç‰Œæ˜¯`SONY`ï¼Œæ‚¨çš„Logoæ–‡ä»¶å°±å¿…é¡»å‘½åä¸º`SONY.png`ã€‚
    - ç›®å‰å·²ç»æ”¾äº†sonyã€å°¼åº·ã€å¯Œå£«ã€å¥¥æ—å·´æ–¯çš„ï¼Œè¿˜å¯ä»¥è‡ªå·±åŠ 
3.  **æ–‡ä»¶å¤¹ç»“æ„**: è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹æ–‡ä»¶å¤¹ï¼š
    - `source/`: **åŸå§‹ç…§ç‰‡å…¥å£**ã€‚è¯·å°†æ‚¨è¦å¤„ç†çš„ç…§ç‰‡æ”¾å…¥æ­¤æ–‡ä»¶å¤¹ã€‚
    - `target/`: **æˆå“å‡ºå£**ã€‚å¸¦æœ‰æ°´å°çš„ç…§ç‰‡ä¼šå‡ºç°åœ¨è¿™é‡Œã€‚
    - `failed_photos/`: å¦‚æœæŸå¼ ç…§ç‰‡å¤„ç†å¤±è´¥ï¼ŒåŸå§‹æ–‡ä»¶ä¼šè¢«ç§»åŠ¨åˆ°è¿™é‡Œï¼Œæ–¹ä¾¿æ‚¨æ’æŸ¥é—®é¢˜ã€‚

#### 5. è®¾ç½®ä¸ºå¼€æœºè‡ªå¯æœåŠ¡ (æ¨èç”¨äºæœåŠ¡å™¨/NAS)

ä¸ºäº†è®© **AutoExifWatermark** åœ¨æ‚¨çš„è®¾å¤‡å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼Œæ¨èä½¿ç”¨`systemd`è¿›è¡Œç®¡ç†ã€‚

1.  **å‡†å¤‡æœåŠ¡æ–‡ä»¶**: 
    é¡¹ç›®æ ¹ç›®å½•ä¸‹æä¾›äº†ä¸€ä¸ªåä¸º `autoexifwatermark.service.template` çš„æ¨¡æ¿æ–‡ä»¶ã€‚é¦–å…ˆï¼Œè¯·å¤åˆ¶ä¸€ä»½å¹¶é‡å‘½åï¼š
    ```bash
    cp autoexifwatermark.service.template autoexifwatermark.service
    ```

2.  **ç¼–è¾‘æœåŠ¡æ–‡ä»¶**: 
    ä½¿ç”¨æ‚¨å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚ `nano`ï¼‰æ‰“å¼€æ–°åˆ›å»ºçš„ `autoexifwatermark.service` æ–‡ä»¶ã€‚
    ```bash
    nano autoexifwatermark.service
    ```
    æ‚¨éœ€è¦æ ¹æ®æ–‡ä»¶å†…çš„æ³¨é‡Šï¼Œä¿®æ”¹ä»¥ä¸‹**å ä½ç¬¦**ä»¥åŒ¹é…æ‚¨çš„ç³»ç»Ÿï¼š
    -   `User=your_user` -> æ›¿æ¢ä¸ºæ‚¨çš„ç”¨æˆ·å (ä¾‹å¦‚: `zsy`)
    -   `Group=your_user` -> æ›¿æ¢ä¸ºæ‚¨çš„ç”¨æˆ·ç»„å (é€šå¸¸ä¸ç”¨æˆ·åç›¸åŒ)
    -   `/path/to/your/AutoExifWatermark` -> æ›¿æ¢ä¸ºé¡¹ç›®çš„**ç»å¯¹è·¯å¾„** (ä¾‹å¦‚: `/home/zsy/AutoExifWatermark`)
    -   ç¡®ä¿`ExecStart`ä¸­çš„Pythonè„šæœ¬å (`autoexifwatermark.py`) ä¸æ‚¨çš„ä¸»è„šæœ¬æ–‡ä»¶åä¸€è‡´ã€‚

3.  **éƒ¨ç½²æœåŠ¡æ–‡ä»¶**: å°†ç¼–è¾‘å¥½çš„æ–‡ä»¶å¤åˆ¶åˆ°`systemd`çš„ç³»ç»Ÿç›®å½•ä¸­ã€‚
    ```bash
    sudo cp autoexifwatermark.service /etc/systemd/system/
    ```

4.  **å¯åŠ¨å¹¶å¯ç”¨æœåŠ¡**:
    ```bash
    sudo systemctl daemon-reload          # é‡æ–°åŠ è½½systemdé…ç½®
    sudo systemctl enable autoexifwatermark.service # è®¾ç½®å¼€æœºè‡ªå¯
    sudo systemctl start autoexifwatermark.service  # ç«‹å³å¯åŠ¨æœåŠ¡
    ```

5.  **æ£€æŸ¥æœåŠ¡çŠ¶æ€**:
    ```bash
    sudo systemctl status autoexifwatermark.service
    # æ‚¨åº”è¯¥ä¼šçœ‹åˆ° 'active (running)' çš„ç»¿è‰²å­—æ ·
    ```



### ğŸš€ å¦‚ä½•ä½¿ç”¨

1.  å°†æ‚¨çš„åŸå§‹ç…§ç‰‡ï¼ˆ`.jpg`æˆ–`.jpeg`æ ¼å¼ï¼‰å¤åˆ¶æˆ–ç§»åŠ¨åˆ°é¡¹ç›®ä¸‹çš„ `source/` æ–‡ä»¶å¤¹ä¸­ã€‚
2.  ç­‰å¾…ç‰‡åˆ»ï¼ˆé»˜è®¤è½®è¯¢å‘¨æœŸä¸º10ç§’ï¼‰ã€‚
3.  åœ¨ `target/` æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°å¤„ç†å®Œæˆã€å¸¦æœ‰ç²¾ç¾æ°´å°çš„ç…§ç‰‡ï¼åŸå§‹ç…§ç‰‡ä¼šè‡ªåŠ¨ä»`source/`æ–‡ä»¶å¤¹ä¸­ç§»é™¤ã€‚

### ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤PRæˆ–Issueæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

### ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MITè®¸å¯è¯](LICENSE)ã€‚
